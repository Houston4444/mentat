<!DOCTYPE html>
<html  dir="ltr">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Mentat</title>
        <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
        <link rel="apple-touch-icon-precomposed" href="images/apple-touch-icon.png">
        <meta name="generator" content="pandoc-uikit" />
                        <title>Mentat</title>
        <style>
            :root {
                --color-text: #333;
                --color-accent: #0090c0;
                --side-width: 300px;
                --p-margin: 20px
            }
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                /* font: inherit; */
            }
            body {
                display: flex;
                flex-direction: row;
                width: 960px;
                /* margin: var(--p-margin) auto 0; */

                font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif;
                line-height: 1.5;
                font-size: 14px;
                color: var(--color-text);
            }
            aside {
                width: var(--side-width);
                margin-right: 20px;
                background: #eee;
            }
            main {
                flex: 1;
                padding-top: var(--p-margin);
                min-width: 0;
            }

            aside ul {
                list-style: none;
            }
            aside > ul {
                list-style: none;
                position: fixed;
                top: 0;
                width: calc(var(--side-width));
                height: 100%;
                padding-top: var(--p-margin);
                overflow-y: auto;
                overflow-x: hidden;
                padding-left: 0;
                white-space: nowrap;
            }
            aside > ul > li {
                margin-left: var(--p-margin);
            }
            aside li {
                margin: 0;
            }
            ul {
                padding-left: 20px;
            }
            main ul ul {
                margin-bottom: 0;
            }
            h1, h2, h3, ul, pre, p {
                margin-bottom: var(--p-margin);
            }
            hr {
                margin: calc(2 * var(--p-margin)) 0;
                opacity: 0.5;
            }
            a {
                text-decoration: none
            }
            aside a {
                color: inherit;
            }
            aside a:hover, main a {
                color: var(--color-accent);
            }
            h1, h2, h3 {
                padding-top: var(--p-margin);
                margin-top: calc(-1 * var(--p-margin));
            }
            .content {
                padding-left: 20px;
            }
            pre, code {
                background: #eee;
                padding: 0 2px;
                border: 1px solid rgba(0,0,0,0.05);
            }
            pre code {
                padding: 0;
                background: none;
                border: none;
            }
            .version {
                opacity: 0.5;
            }
        </style>
    </head>

    <body>

        <aside>
                        <ul>
                        <li><a href="#mentat">Mentat</a>
                        <ul>
                        <li><a href="#overview">Overview</a></li>
                        <li><a href="#install">Install</a></li>
                        <li><a href="#usage">Usage</a></li>
                        </ul></li>
                        <li><a href="#engine">Engine</a>
                        <ul>
                        <li><a href="#engine-1">Engine()</a></li>
                        <li><a
                        href="#engine.start">Engine.start()</a></li>
                        <li><a
                        href="#engine.stop">Engine.stop()</a></li>
                        <li><a
                        href="#engine.restart">Engine.restart()</a></li>
                        <li><a
                        href="#engine.autorestart">Engine.autorestart()</a></li>
                        <li><a
                        href="#engine.add_module">Engine.add_module()</a></li>
                        <li><a
                        href="#engine.send">Engine.send()</a></li>
                        <li><a
                        href="#engine.add_route">Engine.add_route()</a></li>
                        <li><a
                        href="#engine.set_route">Engine.set_route()</a></li>
                        <li><a
                        href="#engine.route">Engine.route()</a></li>
                        <li><a
                        href="#engine.set_tempo">Engine.set_tempo()</a></li>
                        <li><a
                        href="#engine.set_cycle_length">Engine.set_cycle_length()</a></li>
                        <li><a
                        href="#engine.set_time_signature">Engine.set_time_signature()</a></li>
                        <li><a
                        href="#engine.start_cycle">Engine.start_cycle()</a></li>
                        <li><a
                        href="#engine.dispatch_event">Engine.dispatch_event()</a></li>
                        </ul></li>
                        <li><a href="#module">Module</a>
                        <ul>
                        <li><a href="#module-1">Module()</a></li>
                        <li><a
                        href="#module.add_submodule">Module.add_submodule()</a></li>
                        <li><a
                        href="#module.set_aliases">Module.set_aliases()</a></li>
                        <li><a
                        href="#module.add_parameter">Module.add_parameter()</a></li>
                        <li><a href="#module.get">Module.get()</a></li>
                        <li><a href="#module.set">Module.set()</a></li>
                        <li><a
                        href="#module.reset">Module.reset()</a></li>
                        <li><a
                        href="#module.animate">Module.animate()</a></li>
                        <li><a
                        href="#module.stop_animate">Module.stop_animate()</a></li>
                        <li><a
                        href="#module.add_meta_parameter">Module.add_meta_parameter()</a></li>
                        <li><a
                        href="#module.add_alias_parameter">Module.add_alias_parameter()</a></li>
                        <li><a
                        href="#module.send_state">Module.send_state()</a></li>
                        <li><a
                        href="#module.save">Module.save()</a></li>
                        <li><a
                        href="#module.load">Module.load()</a></li>
                        <li><a
                        href="#module.route">Module.route()</a></li>
                        <li><a
                        href="#module.send">Module.send()</a></li>
                        <li><a
                        href="#module.add_event_callback">Module.add_event_callback()</a></li>
                        <li><a
                        href="#module.start_scene">Module.start_scene()</a></li>
                        <li><a
                        href="#module.restart_scene">Module.restart_scene()</a></li>
                        <li><a
                        href="#module.stop_scene">Module.stop_scene()</a></li>
                        <li><a
                        href="#module.wait">Module.wait()</a></li>
                        <li><a
                        href="#module.wait_next_cycle">Module.wait_next_cycle()</a></li>
                        <li><a
                        href="#module.play_sequence">Module.play_sequence()</a></li>
                        </ul></li>
                        <li><a href="#route">Route</a>
                        <ul>
                        <li><a href="#route-1">Route()</a></li>
                        <li><a
                        href="#route.activate">Route.activate()</a></li>
                        <li><a
                        href="#route.deactivate">Route.deactivate()</a></li>
                        <li><a
                        href="#route.route">Route.route()</a></li>
                        <li><a
                        href="#route.start_scene">Route.start_scene()</a></li>
                        <li><a
                        href="#route.restart_scene">Route.restart_scene()</a></li>
                        <li><a
                        href="#route.stop_scene">Route.stop_scene()</a></li>
                        <li><a href="#route.wait">Route.wait()</a></li>
                        <li><a
                        href="#route.wait_next_cycle">Route.wait_next_cycle()</a></li>
                        <li><a
                        href="#route.play_sequence">Route.play_sequence()</a></li>
                        </ul></li>
                        </ul>
                    </aside>

        <main>
<h2 id="mentat">Mentat</h2>
<div class="version">
<p>Version: 1.0.0 (08/06/2022) <br/> License: GNU/GPL v3 (© 2022
Jean-Emmanuel Doucet)</p>
</div>
<h3 id="overview">Overview</h3>
<p>Mentat is a HUB / Conductor for OSC / MIDI capable softwares. It aims
to centralize all controls in one place, manage their state and create
routings.</p>
<p>Mentat is a module for <a href="https://www.python.org/">python 3</a>
and requires writing code to work. If you’re looking for a
fully-featured software with a user interface, try <a
href="https://benjamin.kuperberg.fr/chataigne/en">Chateigne</a>
instead.</p>
<p>Mentat has been designed to coordinate the live setup of the
rap-in-opposition band <a href="https://plagiat.org/clips">Plagiat</a>
(see the project’s <a
href="https://github.com/PlagiatBros/PlagiatSetupII/">source
repository</a>).</p>
<h3 id="install">Install</h3>
<pre><code>git clone https://github.com/jean-emmanuel/mentat/
cd mentat
python3 setup.py install</code></pre>
<h3 id="usage">Usage</h3>
<p>The typical use case for Mentat is a conductor for controlling a set
of softwares during a live performance.</p>
<p>The <a href="#engine"><code>Engine</code></a> object is the main
object, it manages the OSC / MIDI backends, the modules and the routes.
It also holds a tempo, a cycle length (measure) and a time reference
that’s used to create timed scenes and sequences in a musical way (using
beats instead of seconds).</p>
<p><a href="#module"><code>Module</code></a> objects are interfaces
between the controlled softwares and the engine. The <code>Module</code>
class should be subclassed to create dedicated module classes for
different softwares.</p>
<p>A set of controllable parameters can be defined for each module, each
parameter being an alias for an OSC / MIDI value in the controlled
software.</p>
<p>Controlled parameters should only modified using the module’s <a
href="#module.set"><code>set()</code></a> and <a
href="#module.animate"><code>animate()</code></a> methods in order to
guarantee that the state of the modules reflects the actual state of the
softwares. This removes the need for feedback from said softwares and
allows us to trust Mentat as the source of truth during the
performance.</p>
<p>All messages received by the engine that are coming from a software
associated with a module are first passed to that module’s <a
href="#module.route"><code>route()</code></a> method.</p>
<p><a href="#route"><code>Route</code></a> objects represent the
different parts of the performance (eg tracks / songs in a musical
show). The <code>Engine</code> has one active route at a time and will
pass all incoming messages to its <a
href="#route.route"><code>route()</code></a> method.</p>
<p>Each track should be a dedicated class derived from the
<code>Route</code> class. The <a
href="#route.route"><code>route()</code></a> method definition will
allow writing the actual routing that should occur during that
track.</p>
<hr />
<h2 id="engine">Engine</h2>
<p>Main object. Singleton that must be instanciated before any
<code>Module</code> or <code>Route</code> object. The global engine
instance is always accessible via <code>Engine.INSTANCE</code>.</p>
<p><strong>Instance properties</strong></p>
<ul>
<li><code>modules</code>: <code>dict</code> containing modules added to
the engine with names as keys</li>
<li><code>routes</code>: <code>dict</code> containing routes added to
the engine with names as keys</li>
<li><code>active_route</code>: active route object (<code>None</code> by
default)</li>
<li><code>restarted</code>: <code>True</code> if the engine was
restarted using <code>autorestart()</code></li>
<li><code>logger</code>: python logger</li>
<li><code>root_module</code>: module instance that exposes all modules
added to the engine. Allows reaching toplevel module’s parameters by
name with <code>set()</code>, <code>animate()</code>, and creating meta
parameters with multiple modules.</li>
<li><code>tempo</code>: beats per minute</li>
<li><code>cycle_length</code>: quarter notes per cycle</li>
</ul>
<h3 id="engine-1">Engine()</h3>
<div class="content">
<p><i>Engine(name, port, folder, debug=False, tcp_port=None,
unix_port=None)</i><br/></p>
<p>Engine constructor.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: client name</li>
<li><code>port</code>: osc (udp) input port number</li>
<li><code>folder</code>: path to config folder where state files will be
saved to and loaded from</li>
<li><code>debug</code>: set to True to enable debug messages and i/o
statistics</li>
<li><code>tcp_port</code>: osc (tcp) input port number</li>
<li><code>unix_port</code>: osc (unix) input socket path</li>
</ul>
</div>
<h3 id="engine.start">Engine.start()</h3>
<div class="content">
<p><i>start()</i><br/></p>
<p>Start engine. This is usually the last statement in the script as it
starts the processing loop that keeps the engine running.</p>
</div>
<h3 id="engine.stop">Engine.stop()</h3>
<div class="content">
<p><i>stop()</i><br/></p>
<p>Stop engine. This is called automatically when the process is
terminated or when the engine restarts.</p>
</div>
<h3 id="engine.restart">Engine.restart()</h3>
<div class="content">
<p><i>restart()</i><br/></p>
<p>Stop the engine and restart once the process is terminated.</p>
</div>
<h3 id="engine.autorestart">Engine.autorestart()</h3>
<div class="content">
<p><i>autorestart()</i><br/></p>
<p>Enable engine autorestart. This watches the main python script and
all imported modules that are located in the same directoty. Whenever a
file is modified, the engine is restarted.</p>
</div>
<h3 id="engine.add_module">Engine.add_module()</h3>
<div class="content">
<p><i>add_module(module)</i><br/></p>
<p>Add a module. This method will create midi ports if the module’s
protocol is ‘midi’. Modules added with this method will be children of
the engine’s root module instance.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>module</code>: Module object</li>
</ul>
</div>
<h3 id="engine.send">Engine.send()</h3>
<div class="content">
<p><i>send(protocol, port, address, *args)</i><br/></p>
<p>Send OSC / MIDI message.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>protocol</code>: ‘osc’, ‘osc.tcp’, ‘osc.unix’ or ‘midi’</li>
<li><code>port</code>: module name, port number (‘osc’ protocol only) or
unix socket path (‘osc.unix’ protocol only)</li>
<li><code>address</code>: osc address</li>
<li><code>args</code>: values</li>
</ul>
</div>
<h3 id="engine.add_route">Engine.add_route()</h3>
<div class="content">
<p><i>add_route(route)</i><br/></p>
<p>Add a route.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>route</code>: Route object</li>
</ul>
</div>
<h3 id="engine.set_route">Engine.set_route()</h3>
<div class="content">
<p><i>set_route(name)</i><br/></p>
<p>Set active route.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: route name</li>
</ul>
</div>
<h3 id="engine.route">Engine.route()</h3>
<div class="content">
<p><i>route(protocol, port, address, args)</i><br/></p>
<p>Unified route for osc and midi messages, called when the engine
receives a midi or osc message.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>protocol</code>: ‘osc’, ‘osc.tcp’ or ‘midi’</li>
<li><code>port</code>: name of module or port number if unknown</li>
<li><code>address</code>: osc address</li>
<li><code>args</code>: list of values</li>
</ul>
</div>
<h3 id="engine.set_tempo">Engine.set_tempo()</h3>
<div class="content">
<p><i>set_tempo(bpm)</i><br/></p>
<p>Set engine tempo.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>bpm</code>: beats per minute</li>
</ul>
</div>
<h3 id="engine.set_cycle_length">Engine.set_cycle_length()</h3>
<div class="content">
<p><i>set_cycle_length(quarter_notes)</i><br/></p>
<p>Set engine cycle (measure) length in quarter notes.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>quarter_notes</code>: quarter notes per cycle (decimals
allowed)</li>
</ul>
</div>
<h3 id="engine.set_time_signature">Engine.set_time_signature()</h3>
<div class="content">
<p><i>set_time_signature(signature)</i><br/></p>
<p>Set engine cycle (measure) length from a musical time signature.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>signature</code>: <code>string</code> like ‘4/4’, ‘5/4’,
‘7/8’…</li>
</ul>
</div>
<h3 id="engine.start_cycle">Engine.start_cycle()</h3>
<div class="content">
<p><i>start_cycle()</i><br/></p>
<p>Set current time as cycle start. Affects Route.wait_next_cycle()
method.</p>
</div>
<h3 id="engine.dispatch_event">Engine.dispatch_event()</h3>
<div class="content">
<p><i>dispatch_event(event, *args)</i><br/></p>
<p>Dispatch event to bound callback functions.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>event</code>: name of event</li>
<li><code>*args</code>: arguments for the callback function</li>
</ul>
</div>
<hr />
<h2 id="module">Module</h2>
<p>Interface between a software / hardware and the engine.</p>
<p><strong>Instance properties</strong></p>
<ul>
<li><code>engine</code>: Engine instance</li>
<li><code>logger</code>: python logger</li>
<li><code>name</code>: module name</li>
<li><code>parent_module</code>: parent module instance,
<code>None</code> if the module is not a submodule</li>
<li><code>module_path</code>: list of module names, from topmost parent
(excluding the engine’s <code>root_module</code>) to submodule</li>
<li><code>submodules</code>: <code>dict</code> containing submodules
added to the module with names as keys</li>
<li><code>parameters</code>: <code>dict</code> containing parameters
(including meta parameters) added to the module with names as keys</li>
<li><code>meta_parameters</code>: <code>dict</code> containing meta
parameters added to the module with names as keys</li>
</ul>
<h3 id="module-1">Module()</h3>
<div class="content">
<p><i>Module(name, protocol=None, port=None, parent=None)</i><br/></p>
<p>Base Module constructor.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: module name</li>
<li><code>protocol</code>: ‘osc’, ‘osc.tcp’, ‘osc.unix’ or ‘midi’</li>
<li><code>port</code>:
<ul>
<li>port number if protocol is ‘osc’ or ‘osc.tcp’</li>
<li>unix socket path if protocol is ‘osc.unix’</li>
<li><code>None</code> if protocol is ‘midi’ or if no osc input port is
needed</li>
</ul></li>
<li><code>parent</code>: if the module is a submodule, this must be set
to the parent module’s instance</li>
</ul>
</div>
<h3 id="module.add_submodule">Module.add_submodule()</h3>
<div class="content">
<p><i>add_submodule(*modules)</i><br/></p>
<p>Add a submodule. Submodule’s protocol and port can be omitted, in
which case they will be inherited from their parent. The submodule’s
parent instance must be provided in its constructor function
(<code>parent</code> argument).</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>modules</code>: Module objects (one module per argument)</li>
</ul>
</div>
<h3 id="module.set_aliases">Module.set_aliases()</h3>
<div class="content">
<p><i>set_aliases(aliases)</i><br/></p>
<p>Set aliases for submodules. Aliases can be used in place of the
submodule_name argument in some methods.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>aliases</code>: {alias: name} dictionary</li>
</ul>
</div>
<h3 id="module.add_parameter">Module.add_parameter()</h3>
<div class="content">
<p><i>add_parameter(name, address, types, static_args=[],
default=None)</i><br/></p>
<p>Add parameter to module.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: name of parameter</li>
<li><code>address</code>: osc address of parameter. Can be
<code>None</code> if the parameter should not send any message.</li>
<li><code>types</code>: osc typetags string, one letter per value,
including static values</li>
<li><code>static_args</code>: list of static values before the ones that
can be modified</li>
<li><code>default</code>: value or list of values if the parameter has
multiple dynamic values</li>
</ul>
</div>
<h3 id="module.get">Module.get()</h3>
<div class="content">
<p><i>get(parameter_name)</i><br/> <i>get(submodule_name,
param_name)</i><br/></p>
<p>Get value of parameter</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>parameter_name</code>: name of parameter</li>
<li><code>submodule_name</code>: name of submodule</li>
</ul>
<p><strong>Return</strong></p>
<p>List of values</p>
</div>
<h3 id="module.set">Module.set()</h3>
<div class="content">
<p><i>set(parameter_name, <em>args, force_send=False)</i><br/>
<i>set(submodule_name, param_nam, </em>args,
force_send=False)</i><br/></p>
<p>Set value of parameter.</p>
<p>The engine will apply the new value only at the end of current
processing cycle and send a message if the new value differs from the
one that was previously sent.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>parameter_name</code>: name of parameter</li>
<li><code>submodule_name</code>: name of submodule, with wildcard (’*‘)
and range (’[]’) support</li>
<li><code>*args</code>: value(s)</li>
<li><code>force_send</code>: send a message regardless of the last sent
value</li>
<li><code>preserve_animation</code>: by default, animations are
automatically stopped when <code>set()</code> is called, set to
<code>True</code> to prevent that</li>
</ul>
</div>
<h3 id="module.reset">Module.reset()</h3>
<div class="content">
<p><i>reset(name=None)</i><br/></p>
<p>Reset parameter to its default values.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: name of parameter. If omitted, affects all
parameters including submodules’</li>
</ul>
</div>
<h3 id="module.animate">Module.animate()</h3>
<div class="content">
<p><i>animate(parameter_name, start, end, duration, mode=‘beats’,
easing=‘linear’, loop=False)</i><br/> <i>animate(submodule_name,
parameter_name, start, end, duration, mode=‘beats’, easing=‘linear’,
loop=False)</i><br/></p>
<p>Animate parameter.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>parameter_name</code>: name of parameter</li>
<li><code>submodule_name</code>: name of submodule, with wildcard (’*‘)
and range (’[]’) support</li>
<li><code>start</code>: starting value(s), can be None to use currnet
value</li>
<li><code>end</code>: ending value(s)</li>
<li><code>duration</code>: animation duration</li>
<li><code>mode</code>: ‘seconds’ or ‘beats’</li>
<li><code>easing</code>: easing function name.
<ul>
<li>available easings: linear, sine, quadratic, cubic, quartic, quintic,
exponential, random, elastic (sinc)</li>
<li>easing name can be suffixed with <code>-mirror</code> (back and
forth animation)</li>
<li>easing name can be suffixed with <code>-out</code> (inverted and
flipped easing) or <code>-inout</code> (linear interpolation between
default and <code>-out</code>). Example:
<code>exponential-mirror-inout</code>.</li>
</ul></li>
<li><code>loop</code>: if set to <code>True</code>, the animation will
start over when <code>duration</code> is reached (use mirror easing for
back-and-forth loop)</li>
</ul>
</div>
<h3 id="module.stop_animate">Module.stop_animate()</h3>
<div class="content">
<p><i>stop_animate(parameter_name)</i><br/>
<i>stop_animate(submodule_name, param_name)</i><br/></p>
<p>Stop parameter animation.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>parameter_name</code>: name of parameter, can be ’*’ to stop
all animations including submodules’.</li>
<li><code>submodule_name</code>: name of submodule</li>
</ul>
</div>
<h3 id="module.add_meta_parameter">Module.add_meta_parameter()</h3>
<div class="content">
<p><i>add_meta_parameter(name, parameters, getter, setter)</i><br/></p>
<p>Add a special parameter whose value depends on the state of one or
several parameters owned by the module or its submodules.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: name of meta parameter</li>
<li><code>parameters</code>: list of parameter names involved in the
meta parameter. Items may be lists if the parameters are owned by a
submodule (<code>['submodule_name', 'parameter_name']</code>)</li>
<li><code>getter</code>: callback function that will be called with the
values of each <code>parameters</code> as arguments whenever one these
parameters changes. Its return value will define the meta parameter’s
value.</li>
<li><code>setter</code>: callback function used to set the value of each
<code>parameters</code>when when <code>set()</code> is called to change
the meta parameter’s value. The function’s signature must not use *args
or **kwargs arguments.</li>
</ul>
</div>
<h3 id="module.add_alias_parameter">Module.add_alias_parameter()</h3>
<div class="content">
<p><i>add_alias_parameter(name, parameter)</i><br/></p>
<p>Add a special parameter that just mirrors another parameter owned by
the module or its submodules. Under the hood, this creates a meta
parameter with the simplest getter and setters possible.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: name of alias parameter</li>
<li><code>parameter</code>: name of parameter to mirror, may a be list
if the parameter are owned by a submodule
(<code>['submodule_name', 'parameter_name']</code>)</li>
</ul>
</div>
<h3 id="module.send_state">Module.send_state()</h3>
<div class="content">
<p><i>send_state()</i><br/></p>
<p>Send current state of all parameters and submodules’ parameters.</p>
</div>
<h3 id="module.save">Module.save()</h3>
<div class="content">
<p><i>save(name)</i><br/></p>
<p>Save current state (including submodules) to file.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: name of state save (without file extension)</li>
</ul>
</div>
<h3 id="module.load">Module.load()</h3>
<div class="content">
<p><i>load(name)</i><br/></p>
<p>Load state from memory or from file if not preloaded already</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: name of state save (without file extension)</li>
<li><code>force_send</code>: see <code>set()</code></li>
</ul>
</div>
<h3 id="module.route">Module.route()</h3>
<div class="content">
<p><i>route(address, args)</i><br/></p>
<p>Route messages received by the engine on the module’s port. Does
nothing by default, method should be overriden in subclasses. Not called
on submodules.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>address</code>: osc address</li>
<li><code>args</code>: list of values</li>
</ul>
<p><strong>Return</strong></p>
<p><code>False</code> if the message should not be passed to the
engine’s active route after being processed by the module.</p>
</div>
<h3 id="module.send">Module.send()</h3>
<div class="content">
<p><i>send(address, *args)</i><br/></p>
<p>Send message to the module’s port.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>address</code>: osc address</li>
<li><code>*args</code>: values</li>
</ul>
</div>
<h3 id="module.add_event_callback">Module.add_event_callback()</h3>
<div class="content">
<p><i>add_event_callback(event, callback)</i><br/></p>
<p>Bind a callback function to an event.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>event</code>: name of event</li>
<li><code>callback</code>: function or method. The callback’s signature
must match the event’s arguments.</li>
</ul>
<p><strong>Events</strong></p>
<ul>
<li><code>engine_started</code>: emitted when the engine starts.</li>
<li><code>engine_stopping</code>: emitted before the engine stops</li>
<li><code>engine_stopped</code>: emitted when the engine is stopped</li>
<li><code>engine_route_changed</code>: emitted when the engine’s active
route changes
<ul>
<li><code>name</code>: name of active route</li>
</ul></li>
<li><code>parameter_changed</code>: emitted when a module’s parameter
changes. Arguments:
<ul>
<li><code>module</code>: instance of module that emitted the event</li>
<li><code>name</code>: name of parameter</li>
<li><code>value</code>: value of parameter or list of values</li>
</ul></li>
</ul>
</div>
<h3 id="module.start_scene">Module.start_scene()</h3>
<div class="content">
<p><i>start_scene(name, scene, *args, **kwargs)</i><br/></p>
<p>Start scene in a thread. If a scene with the same name is already
running, it will be stopped. Scenes should be implemented as methods of
the object and can call self.wait() to create timed sequences or loops.
Different objects may call a scene with the same name
simultaneously.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: scene name</li>
<li><code>scene</code>: function or method</li>
<li><code>*args</code>: arguments for the scene function</li>
<li><code>**kwargs</code>: keyword arguments for the scene function</li>
</ul>
</div>
<h3 id="module.restart_scene">Module.restart_scene()</h3>
<div class="content">
<p><i>restart_scene(name)</i><br/></p>
<p>Restart a scene that’s already running. Does nothing if the scene is
not running.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: scene name, with wildcard (’*‘) and range (’[]’)
support</li>
</ul>
</div>
<h3 id="module.stop_scene">Module.stop_scene()</h3>
<div class="content">
<p><i>stop_scene(name)</i><br/></p>
<p>Stop scene thread.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: scene name, with wildcard support</li>
</ul>
</div>
<h3 id="module.wait">Module.wait()</h3>
<div class="content">
<p><i>wait(duration, mode=‘beats’)</i><br/></p>
<p>Wait for given amount of time. Can only be called in scenes.
Subsequent calls to wait() in a scene do not drift with time and can be
safely used to create beat sequences. The engine’s <code>tempo</code>
must be set for the <code>beats</code> mode to work.</p>
<pre><code># Example
beat_1()
self.wait(1, &#39;b&#39;) # will wait 1 beat minus beat_1&#39;s exec time
beat_2()
self.wait(1, &#39;b&#39;) # will wait 1 beat minus beat_1 and beat_2&#39;s exec time</code></pre>
<p><strong>Parameters</strong></p>
<ul>
<li><code>duration</code>: amount of time to wait</li>
<li><code>mode</code>: ‘beats’ or ‘seconds’ (only the first letter
matters)</li>
</ul>
</div>
<h3 id="module.wait_next_cycle">Module.wait_next_cycle()</h3>
<div class="content">
<p><i>wait_next_cycle()</i><br/></p>
<p>Wait until next cycle begins. The engine’s <code>tempo</code> and
<code>cycle_length</code> must be set and the engine’s
<code>start_cycle()</code> method must be called at the beginning of a
cycle for this to work.</p>
</div>
<h3 id="module.play_sequence">Module.play_sequence()</h3>
<div class="content">
<p><i>play_sequence(sequence, loop=True)</i><br/></p>
<p>Play a sequence of actions scheduled on arbitrary beats. Can only be
called in scenes.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>sequence</code>:
<ul>
<li><code>dict</code> with beat numbers (1-indexed, quarter note based)
as keys and lambda functions as values</li>
<li><code>list</code> of <code>dict</code> sequences (one sequence = one
bar)</li>
<li>sequences may contain an extra ‘signature’ string to change the time
signature. If not provided in the first sequence, the signature takes
the engine’s cycle length value.</li>
</ul></li>
<li><code>loop</code>: if <code>False</code>, the sequence will play
only once, otherwise it will loop until the scene is stopped</li>
</ul>
<p><strong>Example</strong></p>
<pre><code># single-bar sequence
play_sequence({
    &#39;signature&#39;: &#39;4/4&#39;,
    # beat 1
    1: lambda: guitar.set(&#39;mute&#39;, 1),
    # beat 3
    3: lambda: [guitar.set(&#39;mute&#39;, 0), guitar.set(&#39;disto&#39;, 1)],
    # &quot;and&quot; of beat 4
    4.5: lambda: guitar.set(&#39;disto&#39;, 0),
})

# multi-bar sequence
play_sequence([
    {   # bar 1
        &#39;signature&#39;: &#39;4/4&#39;,
        # beat 1
        1: lambda: voice.set(&#39;autotune&#39;, 1),
    },
    {}, # bar 2 (empty)
    {   # bar 3 (empty, but in 3/4)
        &#39;signature&#39;: &#39;3/4&#39;,
    },
    {   # bar 4 (in 3/4 too)
        # beat 1
        1: lambda: foo.set(&#39;autotune&#39;, 0),
        # beat 3
        3: lambda: foo.set(&#39;autotune&#39;, 1),
    }
])</code></pre>
</div>
<hr />
<h2 id="route">Route</h2>
<p>Routing object that processes messages received by the engine when
active.</p>
<p><strong>Instance properties</strong></p>
<ul>
<li><code>engine</code>: Engine instance</li>
<li><code>logger</code>: python logger</li>
</ul>
<h3 id="route-1">Route()</h3>
<div class="content">
<p><i>Route()</i><br/></p>
<p>Route object constructor.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: route name</li>
</ul>
</div>
<h3 id="route.activate">Route.activate()</h3>
<div class="content">
<p><i>activate()</i><br/></p>
<p>Called when the engine switches to this route.</p>
</div>
<h3 id="route.deactivate">Route.deactivate()</h3>
<div class="content">
<p><i>deactivate()</i><br/></p>
<p>Called when the engine switches to another route.</p>
</div>
<h3 id="route.route">Route.route()</h3>
<div class="content">
<p><i>route(protocol, port, address, args)</i><br/></p>
<p>Process messages received by the engine.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>protocol</code>: ‘osc’, ‘osc.tcp’ or ‘midi’</li>
<li><code>port</code>: name of module or port number if unknown</li>
<li><code>address</code>: osc address</li>
<li><code>args</code>: list of values</li>
</ul>
</div>
<h3 id="route.start_scene">Route.start_scene()</h3>
<div class="content">
<p><i>start_scene(name, scene, *args, **kwargs)</i><br/></p>
<p>Start scene in a thread. If a scene with the same name is already
running, it will be stopped. Scenes should be implemented as methods of
the object and can call self.wait() to create timed sequences or loops.
Different objects may call a scene with the same name
simultaneously.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: scene name</li>
<li><code>scene</code>: function or method</li>
<li><code>*args</code>: arguments for the scene function</li>
<li><code>**kwargs</code>: keyword arguments for the scene function</li>
</ul>
</div>
<h3 id="route.restart_scene">Route.restart_scene()</h3>
<div class="content">
<p><i>restart_scene(name)</i><br/></p>
<p>Restart a scene that’s already running. Does nothing if the scene is
not running.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: scene name, with wildcard (’*‘) and range (’[]’)
support</li>
</ul>
</div>
<h3 id="route.stop_scene">Route.stop_scene()</h3>
<div class="content">
<p><i>stop_scene(name)</i><br/></p>
<p>Stop scene thread.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>name</code>: scene name, with wildcard support</li>
</ul>
</div>
<h3 id="route.wait">Route.wait()</h3>
<div class="content">
<p><i>wait(duration, mode=‘beats’)</i><br/></p>
<p>Wait for given amount of time. Can only be called in scenes.
Subsequent calls to wait() in a scene do not drift with time and can be
safely used to create beat sequences. The engine’s <code>tempo</code>
must be set for the <code>beats</code> mode to work.</p>
<pre><code># Example
beat_1()
self.wait(1, &#39;b&#39;) # will wait 1 beat minus beat_1&#39;s exec time
beat_2()
self.wait(1, &#39;b&#39;) # will wait 1 beat minus beat_1 and beat_2&#39;s exec time</code></pre>
<p><strong>Parameters</strong></p>
<ul>
<li><code>duration</code>: amount of time to wait</li>
<li><code>mode</code>: ‘beats’ or ‘seconds’ (only the first letter
matters)</li>
</ul>
</div>
<h3 id="route.wait_next_cycle">Route.wait_next_cycle()</h3>
<div class="content">
<p><i>wait_next_cycle()</i><br/></p>
<p>Wait until next cycle begins. The engine’s <code>tempo</code> and
<code>cycle_length</code> must be set and the engine’s
<code>start_cycle()</code> method must be called at the beginning of a
cycle for this to work.</p>
</div>
<h3 id="route.play_sequence">Route.play_sequence()</h3>
<div class="content">
<p><i>play_sequence(sequence, loop=True)</i><br/></p>
<p>Play a sequence of actions scheduled on arbitrary beats. Can only be
called in scenes.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>sequence</code>:
<ul>
<li><code>dict</code> with beat numbers (1-indexed, quarter note based)
as keys and lambda functions as values</li>
<li><code>list</code> of <code>dict</code> sequences (one sequence = one
bar)</li>
<li>sequences may contain an extra ‘signature’ string to change the time
signature. If not provided in the first sequence, the signature takes
the engine’s cycle length value.</li>
</ul></li>
<li><code>loop</code>: if <code>False</code>, the sequence will play
only once, otherwise it will loop until the scene is stopped</li>
</ul>
<p><strong>Example</strong></p>
<pre><code># single-bar sequence
play_sequence({
    &#39;signature&#39;: &#39;4/4&#39;,
    # beat 1
    1: lambda: guitar.set(&#39;mute&#39;, 1),
    # beat 3
    3: lambda: [guitar.set(&#39;mute&#39;, 0), guitar.set(&#39;disto&#39;, 1)],
    # &quot;and&quot; of beat 4
    4.5: lambda: guitar.set(&#39;disto&#39;, 0),
})

# multi-bar sequence
play_sequence([
    {   # bar 1
        &#39;signature&#39;: &#39;4/4&#39;,
        # beat 1
        1: lambda: voice.set(&#39;autotune&#39;, 1),
    },
    {}, # bar 2 (empty)
    {   # bar 3 (empty, but in 3/4)
        &#39;signature&#39;: &#39;3/4&#39;,
    },
    {   # bar 4 (in 3/4 too)
        # beat 1
        1: lambda: foo.set(&#39;autotune&#39;, 0),
        # beat 3
        3: lambda: foo.set(&#39;autotune&#39;, 1),
    }
])</code></pre>
</div>
<hr />
        </main>

    </body>
</html>
